:root {
    --bg-system: #F2F2F7;
    --card: #FFFFFF;
    --text: #1C1C1E;
    --dim: #8E8E93;
    --accent: #FF4D2D;
    --glass: rgba(255, 255, 255, 0.85);
    --border: rgba(0,0,0,0.1);
    /* Dynamic viewport height fix */
    --vh: 1vh; 
}

* { 
    box-sizing: border-box; 
    -webkit-tap-highlight-color: transparent; 
    outline: none; 
    -webkit-user-select: none; /* Prevents accidental text selection while swiping */
}

body { 
    background: #E5E5EA; 
    margin: 0; 
    font-family: -apple-system, system-ui, sans-serif; 
    display: flex; 
    justify-content: center; 
    /* Fix for mobile address bars */
    height: 100vh; 
    height: calc(var(--vh, 1vh) * 100);
    overflow: hidden; 
    position: fixed; /* Prevents "rubber-band" scrolling on iOS */
    width: 100%;
}

.iphone-shell { 
    width: 100%; 
    max-width: 500px; 
    height: 100%; 
    background: var(--card); 
    display: flex; 
    flex-direction: column; 
    position: relative; 
    overflow: hidden; 
}
/* --- Header & Scroller --- */
.glass-header { 
    padding: calc(env(safe-area-inset-top) + 15px) 20px 15px; 
    background: var(--glass); 
    backdrop-filter: blur(25px); 
    border-bottom: 1px solid var(--border); 
    z-index: 10; 
}
.top-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.center-title { font-weight: 700; font-size: 17px; color: var(--text); }
.action-text { font-size: 14px; font-weight: 700; color: var(--accent); cursor: pointer; }

.month-selector {
    font-size: 13px; font-weight: 800; color: var(--accent);
    background: rgba(255, 77, 45, 0.1); padding: 8px 16px; border-radius: 20px;
    border: 1px solid rgba(255, 77, 45, 0.2);
    display: inline-flex; align-items: center; gap: 6px; margin-bottom: 15px;
    cursor: pointer; transition: all 0.2s ease;
}
.month-selector:active { transform: scale(0.95); background: rgba(255, 77, 45, 0.2); }

.date-scroller { 
    display: flex; gap: 12px; overflow-x: auto; scrollbar-width: none; 
    scroll-behavior: smooth; padding: 10px 0; -webkit-overflow-scrolling: touch;
}
.date-scroller::-webkit-scrollbar { display: none; }
.date-unit { flex-shrink: 0; text-align: center; cursor: pointer; transition: all 0.2s ease; padding: 5px; }
.d-num { 
    font-size: 15px; font-weight: 700; width: 42px; height: 42px; display: flex; 
    align-items: center; justify-content: center; border-radius: 14px; 
    color: var(--text); background: transparent; transition: all 0.3s ease;
}
.date-unit.active .d-num { 
    background: var(--accent); color: #FFFFFF; 
    box-shadow: 0 8px 20px rgba(255, 77, 45, 0.35); transform: translateY(-2px);
}

/* --- Task View & Swipe --- */
.task-container { flex: 1; overflow-y: auto; overflow-x: hidden; padding: 20px 20px 150px; background-color: var(--bg-system); }
.task-card { 
    background: var(--card); padding: 18px; border-radius: 20px; margin-bottom: 12px; 
    display: flex; gap: 15px; border: 1px solid var(--border);
    position: relative; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, max-height 0.4s ease;
}
.checkbox { width: 22px; height: 22px; border: 2.5px solid #D1D1D6; border-radius: 7px; cursor: pointer; flex-shrink: 0; }
.task-card.done .checkbox { background: #34C759; border-color: #34C759; }
.task-card.done .t-text { text-decoration: line-through; color: var(--dim); }
.task-card.deleting { transform: translateX(-120%); opacity: 0; margin-bottom: 0; max-height: 0; padding: 0; border: none; pointer-events: none; }

/* --- Input Dock --- */
.input-dock { 
    position: absolute; 
    bottom: 0; 
    width: 100%; 
    padding: 15px 20px calc(env(safe-area-inset-bottom) + 15px); 
    background: var(--card); 
    border-top: 1px solid var(--border); 
    z-index: 100; 
}
.dock-card { background: #f1f1f6; padding: 16px; border-radius: 24px; }
#task-input { border: none; width: 100%; font-size: 16px; background: transparent; color: var(--text); padding-bottom: 12px; font-weight: 500; }
.dock-controls { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 10px; }
.icon-submit-btn { background: var(--accent); border: none; color: white; width: 42px; height: 36px; border-radius: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; }

/* --- MODAL NAVIGATION (FIXED ARROWS) --- */
.modal-nav { 
    display: flex; 
    align-items: center; 
    justify-content: space-between; /* Pushes arrows to the sides */
    width: 100%;
    margin-bottom: 20px; 
}
.nav-btn { 
    background: var(--bg-system); border: none; color: var(--accent); 
    width: 38px; height: 38px; border-radius: 50%; 
    display: flex; align-items: center; justify-content: center; cursor: pointer; 
}
#modal-month-label { margin: 0; font-size: 17px; font-weight: 700; color: var(--text); }

/* --- Analytics Sidebar --- */
.sidebar-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.4); z-index: 1000; opacity: 0; pointer-events: none; transition: 0.3s; }
.sidebar-overlay.open { opacity: 1; pointer-events: all; }
.sidebar-content { position: absolute; bottom: 0; width: 100%; height: 75%; background: var(--card); border-radius: 30px 30px 0 0; padding: 20px 25px; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.2, 1, 0.3, 1); display: flex; flex-direction: column; overflow: hidden; }
.sidebar-overlay.open .sidebar-content { transform: translateY(0); }
.segmented-control { display: flex; background: #E5E5EA; padding: 2px; border-radius: 10px; width: 100%; margin-bottom: 20px; }
.segmented-control .tab-btn { flex: 1; border: none; background: transparent; padding: 8px 0; font-size: 13px; font-weight: 600; color: var(--text); border-radius: 8px; cursor: pointer; }
.segmented-control .tab-btn.active { background: var(--card); box-shadow: 0 3px 8px rgba(0,0,0,0.12); }

/* --- Calendar Modal Styling --- */
.modal-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(10px); z-index: 2000; display: none; align-items: center; justify-content: center; }
.modal-overlay.open { display: flex; }
.modal-content { background: var(--card); width: 90%; max-width: 340px; border-radius: 25px; padding: 25px 20px; }
.calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin-top: 10px; text-align: center; }
.grid-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 50%; cursor: pointer; color: var(--text); }
.grid-day.selected { background: var(--accent); color: white; }
.calendar-grid-header { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; margin-bottom: 10px; font-size: 11px; font-weight: 800; color: var(--dim); }

/* --- Dark Mode --- */
body.dark-mode .iphone-shell { --bg-system: #000; --card: #1C1C1E; --text: #FFF; --glass: rgba(28, 28, 30, 0.85); --dim: #8E8E93; --border: rgba(255,255,255,0.05); }
body.dark-mode .dock-card { background: #121214; }
body.dark-mode .segmented-control { background: #2C2C2E; }
body.dark-mode .segmented-control .tab-btn.active { background: #636366; color: #FFF; }

/* --- Drop-Up --- */
.drop-up-content { position: absolute; bottom: 85px; left: 0; width: 180px; background: var(--card); border-radius: 18px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid var(--border); display: none; flex-direction: column; z-index: 1000; }
.drop-up-content.show { display: flex; }
.drop-item { padding: 12px 16px; font-size: 14px; font-weight: 600; color: var(--text); cursor: pointer; }

/* Sidebar Appearance Section */
.theme-menu p {
    font-size: 13px;
    font-weight: 700;
    color: var(--dim);
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.theme-btns {
    display: flex;
    background: #E5E5EA; /* Matching segmented control background */
    padding: 2px;
    border-radius: 10px;
}

.t-btn {
    flex: 1;
    border: none;
    background: transparent;
    padding: 10px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
    border-radius: 8px;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
}

/* Active Pill Effect */
.t-btn.active {
    background: var(--card);
    box-shadow: 0 3px 8px rgba(0,0,0,0.12), 0 3px 1px rgba(0,0,0,0.04);
}

/* Dark Mode Adjustment for the background track */
body.dark-mode .theme-btns {
    background: #2C2C2E;

}
